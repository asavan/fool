(()=>{"use strict";var e,t,n={392:(e,t,n)=>{function a(e){e&&e.classList.add("hidden")}function r(e){e&&e.classList.remove("hidden")}function o(e){e&&e.remove()}function c(e,t,n){e.logger&&(n.innerHTML+="object"==typeof t?(JSON&&JSON.stringify?JSON.stringify(t):t)+"<br />":t+"<br />")}function l(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function i(e,t,n){const a=e.location.search,r=new URLSearchParams(a);for(const[e,t]of r)"number"==typeof n[e]?n[e]=parseInt(t,10):"boolean"==typeof n[e]?n[e]=l(t):n[e]=t}n.d(t,{Bk:()=>i,N8:()=>a,cM:()=>c,ew:()=>o,gw:()=>s,hu:()=>u,oX:()=>r});const s=e=>new Promise((t=>setTimeout(t,e)));function u(e,t){if(!e)throw t}}},a={};function r(e){var t=a[e];if(void 0!==t)return t.exports;var o=a[e]={exports:{}};return n[e](o,o.exports,r),o.exports}r.m=n,r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,n)=>(r.f[n](e,t),t)),[])),r.u=e=>e+"."+{749:"ea25446fce17161feba2",945:"07039a00e5bcd0ad453b",970:"b930b7d137077015d30f"}[e]+".js",r.miniCssF=e=>{},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="fool:",r.l=(n,a,o,c)=>{if(e[n])e[n].push(a);else{var l,i;if(void 0!==o)for(var s=document.getElementsByTagName("script"),u=0;u<s.length;u++){var d=s[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==t+o){l=d;break}}l||(i=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.setAttribute("data-webpack",t+o),l.src=n),e[n]=[a];var f=(t,a)=>{l.onerror=l.onload=null,clearTimeout(p);var r=e[n];if(delete e[n],l.parentNode&&l.parentNode.removeChild(l),r&&r.forEach((e=>e(a))),t)return t(a)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=f.bind(null,l.onerror),l.onload=f.bind(null,l.onload),i&&document.head.appendChild(l)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&!e;)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={179:0};r.f.j=(t,n)=>{var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var o=new Promise(((n,r)=>a=e[t]=[n,r]));n.push(a[2]=o);var c=r.p+r.u(t),l=new Error;r.l(c,(n=>{if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var o=n&&("load"===n.type?"missing":n.type),c=n&&n.target&&n.target.src;l.message="Loading chunk "+t+" failed.\n("+o+": "+c+")",l.name="ChunkLoadError",l.type=o,l.request=c,a[1](l)}}),"chunk-"+t,t)}};var t=(t,n)=>{var a,o,[c,l,i]=n,s=0;if(c.some((t=>0!==e[t]))){for(a in l)r.o(l,a)&&(r.m[a]=l[a]);if(i)i(r)}for(t&&t(n);s<c.length;s++)o=c[s],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkfool=self.webpackChunkfool||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{const e={modes:["net","ai","server"],mode:"net",wsPort:8088,color:"red",logger:!0,networkDebug:!1};var t=r(392);function n(e,t,n,a,r){const o=t.querySelector(".places");o.replaceChildren();const c=t.createElement("ul");c.classList.add("circle-wrapper"),o.appendChild(c);const l=360/r.length;let i=90,s=null;c.addEventListener("click",(function(e){if(e.preventDefault(),e.target&&null!==e.target.dataset.id){if(s)return s.classList.remove("selected"),a.swap(s.dataset.id,e.target.dataset.id),void(s=null);s=e.target,s.classList.add("selected")}}));for(let e=0;e<r.length;++e){const n=t.createElement("li");n.innerText=r[e].name,n.dataset.id=e,n.dataset.angle=i+"deg",n.style.setProperty("--angle-deg",i+"deg"),n.classList.add("circle","clickable"),i+=l,c.appendChild(n)}const u=t.createElement("button");u.classList.add("start-button","clickable"),u.addEventListener("click",(function(e){e.preventDefault(),o.replaceChildren(),a.onSeatsFinished()})),o.appendChild(u)}function a(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1)),a=e[t];e[t]=e[n],e[n]=a}}const o={newShuffledDeck:async function(e){let t=function(){const e=[...Array(112).keys()];return e.splice(56,1),e.splice(69,1),e.splice(82,1),e.splice(95,1),e}();return a(t),await e.shuffle(t),{deal:function(){return t.pop()},addCardAndShuffle:async function(n){!function(e){t.push(e)}(n),a(t),await e.shuffle(t)},setDeck:function(e){t=e}}},newExternalDeck:function(e,t){let n=e;return{deal:function(){return n.pop()},addCardAndShuffle:async function(e){!function(e){n.push(e)}(e),a(n),await t.shuffle(n)},setDeck:function(e){n=e}}}};const c={newPlayer:function(e,t,n){const a=e,r=t,o=[];let c=0;return{getName:()=>a,addCard:e=>{o.push(e)},pile:()=>[...o],getIndex:()=>r,cleanHand:async()=>{o.length=0,await n.clearPlayer(r)},removeCard:e=>{const t=o.indexOf(e);return t<0||o.splice(t,1),t},updateScore:e=>{c+=e},getScore:()=>c}}};function l(e){}const i={shuffle:l,deal:l,draw:l,discard:l,move:l,clearPlayer:l,ready:l,changeCurrent:l,gameover:l,roundover:l,chooseColor:function(){return m}};async function s(e,...t){const n=i[e];if("function"==typeof n)return await n(...t)}const u=7;let d=0,f=1,p=[],h=null,w=null,y=[],g=null,m=null,v=0,C=!1;function b(e,t){return(e+f+t)%t}function S(e,t){return(d+(e+1)*f+t)%t}function k(){return w}const D=["red","yellow","green","blue"];function E(e){let t;if(e%14==13)return"black";switch(Math.floor(e/14)){case 0:case 4:t="red";break;case 1:case 5:t="yellow";break;case 2:case 6:t="green";break;case 3:case 7:t="blue"}return t}function L(e){switch(e%14){case 10:return"Skip";case 11:return"Reverse";case 12:return"Draw2";case 13:return Math.floor(e/14)>=4?"Draw4":"Wild";default:return"Number "+e%14}}function P(e){let t;switch(e%14){case 10:case 11:case 12:t=20;break;case 13:t=50;break;default:t=e%14}return t}function x(e){const t=p.length;p.push(c.newPlayer(e,t,i))}async function q(e,t){const n=e.deal();return p[t].addCard(n),await i.draw({playerIndex:t,card:n}),n}async function N(e,t){await q(h,e)}async function T(e){await I(h)}async function I(e){let t=e.deal();for(w=t,await i.discard(t);"black"===E(t);)w=null,await e.addCardAndShuffle(t),t=e.deal(),w=t,await i.discard(t);return y.push(t),t}function A(e,t){i[e]=t}function j(){return{[Symbol.iterator](){let e=0;return{next:()=>e>=p.length?{done:!0,value:e}:{done:!1,value:p[e++]},return:()=>({done:!0})}}}}function O(){return p.length}function M(){return d}function H(){return g}async function B(){h=await o.newShuffledDeck(i);let e=[...p];for(;e.length>1;){const t=e.length;let n=new Array(t),a=0;for(let r=0;r<t;r++){const o=S(r,t),c=P(await q(h,e[o].getIndex()));n[o]=c,a=Math.max(a,c)}const r=[];for(let o=0;o<t;o++)n[o]===a&&r.push(e[o]);e=r}e.length>=1&&(d=e[0].getIndex()),g=d}async function F(){w=null,y=[];for(const e of p)await e.cleanHand();h=await o.newShuffledDeck(i)}async function J(){return g=b(g+f,p.length),await i.changeCurrent(g)}async function W(e,t){const n=L(e),a=E(e);if("black"!=a&&(m=a),"Reverse"!==n)if("Skip"!==n)if("Draw2"!==n)if("Draw4"!==n)z();else{for(let e=0;e<4;++e)await q(h,b(g,p.length));await J()}else{for(let e=0;e<2;++e)await q(h,b(g,p.length));await J()}else await J();else 2===p.length?await J():await async function(){return f*=-1,g=b(g,p.length),await s("changeCurrent",g)}()}async function R(){await F();for(let e=0;e<u;++e){const e=p.length;for(let t=0;t<e;t++){const n=S(t,e);await q(h,p[n].getIndex())}}const e=await I(h);await W(e)}async function $(e,t){if(e!==g)return!1;if(C)return!1;if("Wild"===L(t)){const t=await i.chooseColor(e);return!!D.includes(t)&&(m=t,!0)}if("Draw4"===L(t)){if(function(e,t){return p[e].pile().find((e=>E(e)===t))}(e,m))return!1;const t=await i.chooseColor(e);return!!D.includes(t)&&(m=t,!0)}return E(t)==m||L(t)==L(w)}async function _(e,t){if(await $(e,t)){const n=p[e].removeCard(t);w=t,y.push(t),await i.move(n),await W(t),0===p[e].pile().length&&(C=!0,p[e].updateScore(async function(){let e=0;const t=j();for(const n of t)for(const t of n.pile())e+=P(t);return e}()),await i.roundover())}}async function z(){return g=b(g,p.length),await i.changeCurrent(g)}async function U(){return d=b(g,p.length),C=!1,await s("nextDealer",d)}async function X(){if(v>0)return v=0,void await z();v++,await q(h,g)}async function G(e){null==h?h=o.newExternalDeck(e,i):h.setDeck(e)}function K(e){g=e}function Q(){return{chooseDealer:B,deal:R,getPlayerIterator:j,addPlayer:x,size:O,on:A,cardScore:P,cardColor:E,cardType:L,getDealer:M,getCurrentPlayer:H,getCardOnBoard:k,tryMove:$,moveToDiscard:_,drawCurrent:X,setDeck:G,onDraw:N,onDiscard:T,setCurrent:K,cleanAllHands:F,nextDealer:U}}const V=["red","yellow","green","blue"];function Y(e,t,n){return n.on("chooseColor",(()=>function(e){return new Promise(((t,n)=>{const a=e.querySelector(".color-picker-holder");a.replaceChildren();const r=e.createElement("ul");r.classList.add("color-grid"),a.appendChild(r);for(const n of V){const o=e.createElement("li");o.classList.add(n),o.addEventListener("click",(e=>{e.preventDefault(),a.replaceChildren(),t(n)})),r.appendChild(o)}}))}(t))),{}}let Z=[];function ee(e,t){const n=t.content.cloneNode(!0).firstElementChild;return n.style.setProperty("--sprite-x",1400-e%14*100+"%"),n.style.setProperty("--sprite-y",800-100*Math.floor(e/14)+"%"),n.dataset.card=e,n}function te(e,t,n){const a=e.createElement("ul"),r=e.querySelector("#card");a.classList.add("hand");for(const e of n)a.appendChild(ee(e,r));t.appendChild(a)}function ne(e,t,n){const a=t.querySelector(".places");a.replaceChildren();const r=t.createElement("ul");r.classList.add("circle-wrapper"),a.appendChild(r);const o=360/n.size();let c=90;const l=n.getPlayerIterator();let i=0;const s=n.getDealer(),u=n.getCurrentPlayer();for(const e of l){const n=t.createElement("li"),a=t.createElement("span");a.innerText=e.getName(),n.appendChild(a);const l=e.getScore();if(l>0){const e=t.createElement("span");e.innerText=l,n.appendChild(e)}te(t,n,e.pile()),n.dataset.id=i,n.dataset.angle=c+"deg",n.style.setProperty("--angle-deg",c+"deg"),n.classList.add("circle","player-name"),s===i&&n.classList.add("dealer"),u===i&&n.classList.add("current-player"),c+=o,r.appendChild(n),++i}ae(e,t,n.getCardOnBoard(),n),r.addEventListener("click",(async e=>{e.preventDefault();const t=e.target.parentElement;if(t&&t.classList.contains("card")){const e=t.parentElement.parentElement,a=parseInt(t.dataset.card),r=parseInt(e.dataset.id);await n.moveToDiscard(r,a)}}))}function ae(e,t,n,a){const r=t.querySelector(".places");let o=r.querySelector(".center-pile");o?o.replaceChildren():(o=t.createElement("div"),o.classList.add("center-pile"),r.appendChild(o)),null!==n&&function(e,t,n,a){const r=e.createElement("ul"),o=e.querySelector("#card");r.classList.add("hand"),r.appendChild(ee(n,o));const c=e.querySelector("#back").content.cloneNode(!0).firstElementChild;r.appendChild(c),c.addEventListener("click",(async e=>{e.preventDefault(),await a.drawCurrent()})),t.appendChild(r)}(t,o,n,a)}function re(e,n,a,r,o){const c=Q();Z=r;for(const e of Z)c.addPlayer(e.name);n.querySelector(".hand-cont");return c.on("draw",(async({playerIndex:a,card:r})=>{ne(e,n,c),await(0,t.gw)(30),await o.draw({playerIndex:a,card:r})})),c.on("changeCurrent",(async a=>{ne(e,n,c),await(0,t.gw)(30),await o.changeCurrent(a)})),c.on("move",(async a=>{ne(e,n,c),await(0,t.gw)(30),await o.move(a)})),c.on("discard",(async e=>{ae(0,n,e,c),await(0,t.gw)(30),await o.discard(e)})),c.on("shuffle",(async a=>{ne(e,n,c),await(0,t.gw)(300),await o.shuffle(a)})),c.on("deal",(()=>{})),c.on("gameover",(async()=>{await o.gameover()})),c.on("clearPlayer",(async e=>{await o.clearPlayer(e)})),Y(0,n,c),c.on("roundover",(async()=>{await(0,t.gw)(200),await c.cleanAllHands(),await(0,t.gw)(300),await c.nextDealer(),await c.deal()})),{chooseDealer:async function(){return await c.chooseDealer()},deal:async function(){return await c.deal()},draw:async function(e){return await c.deal()},start:function(){},onShuffle:async function(t){await c.setDeck(t),ne(e,n,c)},onDraw:async function(e,t){return c.onDraw(e,t)},onDiscard:async function(e){return c.onDiscard(e)},onChangeCurrent:async function(t){c.setCurrent(t),ne(e,n,c)},onClearHand:async function(t){await c.cleanAllHands(),ne(e,n,c)}}}function oe(e){}const ce={move:oe,gameover:oe,username:oe,start:oe,swap:oe,"uno-start":oe,shuffle:oe,draw:oe,discard:oe,chooseColor:oe,clearPlayer:oe,changeCurrent:oe};let le=[];function ie(e,a,r){let o=null;function c(e,t){ce[e]=t}const l=()=>{ce.start(le)},i=a.querySelector(".start");i&&i.addEventListener("click",l);const s=async e=>{await e.chooseDealer(),await(0,t.gw)(1e3),await e.deal(),await e.start()},u=async()=>{l(),o=re(e,a,0,le,ce),await s(o)};c("onSeatsFinished",u);return{on:c,onChange:function(e){},join:(e,t,r)=>{le[e]={name:t,external_id:r},n(0,a,0,ce,le)},start:l,onConnect:()=>{!function(e,t,n,a){const r=t.querySelector(".name-form-cont"),o=t.querySelector("#nameform").content.cloneNode(!0).firstElementChild;r.replaceChildren(o);const c=t.querySelector(".nameform"),l=t.querySelector(".nameinput"),i=t.querySelector(".container");let s=e.sessionStorage.getItem("username");function u(e){a.username(e),c.classList.add("hidden"),i.classList.remove("hidden")}"net"==n.mode&&i.classList.add("hidden"),s&&u(s),c.addEventListener("submit",(function(t){t.preventDefault(),e.sessionStorage.setItem("username",l.value),u(l.value)}))}(e,a,r,ce)},swap:(e,t)=>{const r=le[e];le[e]=le[t],le[t]=r,n(0,a,0,ce,le)},onStart:t=>{le=t,o=re(e,a,0,le,ce);a.getElementsByClassName("places")[0].style.backgroundColor="blueviolet"},main:s,afterAllJoined:u,onShuffle:e=>{if(null!=o)return o.onShuffle(e)},onDraw:(e,t)=>{o.onDraw(e,t)},onDiscard:e=>{if(null!=o)return o.onDiscard(e)},onChangeCurrent:e=>{if(null!=o)return o.onChangeCurrent(e)},onClearHand:e=>{if(null!=o)return o.onClearHand(e)}}}"serviceWorker"in navigator&&(navigator.serviceWorker.register("./sw.js",{scope:"./"}),function(e,n){const a=n.querySelector(".butInstall");let r;a.addEventListener("click",(e=>{e.preventDefault(),(0,t.N8)(a),r.prompt(),r.userChoice.then((e=>{}))})),e.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),r=e,(0,t.oX)(a)}))}(window,document)),function(n,a){(0,t.Bk)(n,a,e),"net"===e.mode?r.e(970).then(r.bind(r,970)).then((t=>{t.default(n,a,e,ie)})):"server"===e.mode?r.e(749).then(r.bind(r,749)).then((t=>{t.default(n,a,e,ie)})):"ai"===e.mode?r.e(945).then(r.bind(r,945)).then((t=>{t.default(n,a,e,ie)})):(0,t.hu)(!1,"Unsupported mode")}(window,document)})()})();