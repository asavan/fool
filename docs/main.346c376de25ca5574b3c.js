(()=>{"use strict";var e,t,n={392:(e,t,n)=>{function r(e){e&&e.classList.add("hidden")}function a(e){e&&e.classList.remove("hidden")}function o(e){e&&e.remove()}function c(e,t,n){e.logger&&(n.innerHTML+="object"==typeof t?(JSON&&JSON.stringify?JSON.stringify(t):t)+"<br />":t+"<br />")}function s(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function l(e,t,n){const r=e.location.search,a=new URLSearchParams(r);for(const[e,t]of a)"number"==typeof n[e]?n[e]=parseInt(t,10):"boolean"==typeof n[e]?n[e]=s(t):n[e]=t}n.d(t,{Bk:()=>l,N8:()=>r,cM:()=>c,ew:()=>o,gw:()=>i,hu:()=>d,oX:()=>a});const i=e=>new Promise((t=>setTimeout(t,e)));function d(e,t){if(!e)throw t}}},r={};function a(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,a),o.exports}a.m=n,a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,n)=>(a.f[n](e,t),t)),[])),a.u=e=>e+"."+{749:"10295f5ee7e0dd6dc65a",945:"14a26e935805c7a71c0e",970:"ea0459bcabaca8a6a07c"}[e]+".js",a.miniCssF=e=>{},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="fool:",a.l=(n,r,o,c)=>{if(e[n])e[n].push(r);else{var s,l;if(void 0!==o)for(var i=document.getElementsByTagName("script"),d=0;d<i.length;d++){var u=i[d];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+o){s=u;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,a.nc&&s.setAttribute("nonce",a.nc),s.setAttribute("data-webpack",t+o),s.src=n),e[n]=[r];var f=(t,r)=>{s.onerror=s.onload=null,clearTimeout(p);var a=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((e=>e(r))),t)return t(r)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),l&&document.head.appendChild(s)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!e;)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={179:0};a.f.j=(t,n)=>{var r=a.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,a)=>r=e[t]=[n,a]));n.push(r[2]=o);var c=a.p+a.u(t),s=new Error;a.l(c,(n=>{if(a.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),c=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+c+")",s.name="ChunkLoadError",s.type=o,s.request=c,r[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,o,[c,s,l]=n,i=0;if(c.some((t=>0!==e[t]))){for(r in s)a.o(s,r)&&(a.m[r]=s[r]);if(l)l(a)}for(t&&t(n);i<c.length;i++)o=c[i],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkfool=self.webpackChunkfool||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{const e={modes:["net","ai","server"],mode:"net",wsPort:8088,logger:!0,networkDebug:!1,cardsDeal:7,maxScore:500,showAll:!1,clickAll:!1,show:!0,externalId:"server",colorOrder:["red","yellow","green","blue","black"],sortByColor:"asc",seed:""};function t(e,t,n,r){const a=t.querySelector(".name-form-cont"),o=e.sessionStorage.getItem("username");if(o)return r.username(o),void a.replaceChildren();if(a.childElementCount>0)return;const c=t.querySelector("#nameform").content.cloneNode(!0).firstElementChild;a.replaceChildren(c);const s=t.querySelector(".nameform"),l=t.querySelector(".nameinput"),i=t.querySelector(".container");"net"==n.mode&&i.classList.add("hidden"),s.addEventListener("submit",(function(t){var n;t.preventDefault(),e.sessionStorage.setItem("username",l.value),n=l.value,r.username(n),s.classList.add("hidden"),i.classList.remove("hidden"),a.replaceChildren()}))}function n(e,t,n,r,a){const o=t.querySelector(".places");o.replaceChildren();const c=t.createElement("ul");c.classList.add("circle-wrapper"),o.appendChild(c);const s=360/a.length;let l=90,i=null;c.addEventListener("click",(function(e){if(e.preventDefault(),e.target&&null!==e.target.dataset.id){if(i)return i.classList.remove("selected"),r.swap(i.dataset.id,e.target.dataset.id),void(i=null);i=e.target,i.classList.add("selected")}}));for(let e=0;e<a.length;++e){if(null==a[e]){l+=s;continue}const n=t.createElement("li");n.innerText=a[e].name,n.dataset.id=e,n.dataset.angle=l+"deg",n.style.setProperty("--angle-deg",l+"deg"),n.classList.add("circle","clickable"),l+=s,c.appendChild(n)}const d=t.createElement("button");d.textContent="Start",d.classList.add("start-button","clickable"),d.addEventListener("click",(function(e){e.preventDefault(),o.replaceChildren(),r.onSeatsFinished()})),o.appendChild(d)}var r=a(392);function o(e,t){for(let n=e.length-1;n>0;n--){const r=Math.floor(t()*(n+1)),a=e[n];e[n]=e[r],e[r]=a}}function c(e,t,n){let r=e;return{deal:function(){return r.pop()},addCardAndShuffle:async function(e){!function(e){r.push(e)}(e),o(r,n),await t.shuffle(r)},setDeck:function(e){r=e},checkTop:function(e){const t=r.at(-1)===e;return t}}}const s={newShuffledDeck:async function(e,t){let n=function(){const e=[...Array(112).keys()];return e.splice(56,1),e.splice(69,1),e.splice(82,1),e.splice(95,1),e}();return o(n,t),await e.shuffle(n),c(n,e,t)},newExternalDeck:c};const l={newPlayer:function(e,t,n){const r=e,a=t,o=[];let c=0;return{getName:()=>r,addCard:e=>{o.push(e)},pile:()=>[...o],getIndex:()=>a,cleanHand:async()=>{o.length=0,await n.clearPlayer(a)},removeCard:e=>{const t=o.indexOf(e);return t<0||o.splice(t,1),t},updateScore:e=>{c+=e},getScore:()=>c,setScore:e=>{c=e}}}};function i(e){}function d(e){}const u={shuffle:d,deal:d,draw:d,discard:d,move:d,clearPlayer:d,ready:d,changeCurrent:d,changeDealer:d,gameover:d,roundover:d,pass:i,drawExternal:i,moveExternal:i,chooseColor:k};let f=500,p=0,h=1,y=[],w=null,m=!0,g=null,v=[],C=null,b=null,x=0,E=0,S=!1;function k(){return b}function P(){return h}function D(e,t){return(e+h+t)%t}function L(e,t){return(p+(e+1)*h+t)%t}function I(){return g}const T=["red","yellow","green","blue"];function N(e){let t;if(e%14==13)return"black";switch(Math.floor(e/14)){case 0:case 4:t="red";break;case 1:case 5:t="yellow";break;case 2:case 6:t="green";break;case 3:case 7:t="blue"}return t}function q(e){switch(e%14){case 10:return"Skip";case 11:return"Reverse";case 12:return"Draw2";case 13:return Math.floor(e/14)>=4?"Draw4":"Wild";default:return"Number "+e%14}}function O(e){let t;switch(e%14){case 10:case 11:case 12:t=20;break;case 13:t=50;break;default:t=e%14}return t}function B(e){if(!e)return!1;const t=y.length;return y.push(l.newPlayer(e,t,u)),!0}async function A(e,t,n){const r=e.deal();return y[t].addCard(r),n?await u.drawExternal({playerIndex:t,card:r}):await u.draw({playerIndex:t,card:r}),r}async function M(e,t){if(!w.checkTop(t))return;await A(w,e,!0);return x++,!0}async function j(e){if(e!==C)return;if(S)return!1;if(x>0)return;x++;return await A(w,C)}async function H(e){if(e===C){if(S)return!1;if(0!=x)return await re(),await u.pass({playerIndex:e}),!0}}async function R(e,t,n){const r=await async function(e,t,n){const r=await async function(e,t,n){if(e!==C)return!1;if(!V(e,t))return!1;if(!T.includes(n))return!1;if(S)return!1;if(E>0)return!1;if("Wild"===q(t))return!0;if("Draw4"===q(t))return!Q(e,b);if(N(t)!=n)return!1;if(N(t)==b)return!0;if(q(t)==q(g))return!0;return!1}(e,t,n);if(r){y[e].removeCard(t);g=t,v.push(t),b=n,++E,await u.moveExternal({playerIndex:e,card:t,currentColor:b}),m&&(await X(t,C),await ee(e))}return r}(e,t,n);return r}async function _(e){if(!w.checkTop(e))return;w.deal();g=e,await u.discard(e);const t=N(e);"black"!==t&&(v.push(e),b=t)}function W(e,t){u[e]=t}function F(){return{[Symbol.iterator](){let e=0;return{next:()=>e>=y.length?{done:!0,value:e}:{done:!1,value:y[e++]},return:()=>({done:!0})}}}}function J(){return y.length}function z(){return p}function G(){return C}async function $(e){g=null,v=[],y[e].cleanHand()}function U(){C=D(C,y.length),x=0,E=0}async function X(e,t){const n=q(e);if("Reverse"===n&&(2===y.length?U():h*=-1),"Skip"===n&&U(),"Draw2"===n){U();for(let e=0;e<2;++e)await A(w,C)}if("Draw4"===n){U();for(let e=0;e<4;++e)await A(w,C)}await re()}async function K(e,t){await async function(e){g=null,v=[];for(const e of y)await e.cleanHand();w=await s.newShuffledDeck(u,e)}(t);for(let t=0;t<e;++t){const e=y.length;for(let t=0;t<e;t++){const n=L(t,e);await A(w,y[n].getIndex())}}const n=await async function(e){let t=e.deal();for(g=t,await u.discard(t);"black"===N(t);)g=null,await e.addCardAndShuffle(t),t=e.deal(),g=t,await u.discard(t);return v.push(t),b=N(t),t}(w);await X(n)}function Q(e,t){return y[e].pile().find((e=>N(e)===t))}function V(e,t){return y[e].pile().includes(t)}async function Y(e,t){if(e!==C)return!1;if(!V(e,t))return!1;if(S)return!1;if(E>0)return!1;if("Wild"===q(t)){const t=await u.chooseColor(e);return!!T.includes(t)&&(b=t,!0)}if("Draw4"===q(t)){if(Q(e,b))return!1;const t=await u.chooseColor(e);return!!T.includes(t)&&(b=t,!0)}return N(t)==b||q(t)==q(g)}async function Z(e,t){const n=await Y(e,t);if(n){y[e].removeCard(t);g=t,v.push(t);const n=N(t);"black"!=n&&(b=n),++E,await u.move({playerIndex:e,card:t,currentColor:b}),m&&(await X(t),await ee(e))}return n}async function ee(e,t){const n=y[e];if(0===n.pile().length){S=!0;const t=function(){let e=0;const t=F();for(const n of t)for(const t of n.pile())e+=O(t);return e}();n.updateScore(t),n.getScore()>=f?await u.gameover({playerIndex:e,score:n.getScore(),diff:t}):await u.roundover({playerIndex:e,score:n.getScore(),diff:t})}}async function te(e){const t=y[e.playerIndex],n=t.getScore();x=0,E=0,S=!1,e.score==n+e.diff&&t.setScore(e.score)}function ne(e){return e==C&&re()}async function re(){return U(),x=0,E=0,await u.changeCurrent({currentPlayer:C,dealer:p,direction:h}),!0}async function ae(){return h=1,p=D(p,y.length),C=p,S=!1,x=0,E=0,await u.changeCurrent({currentPlayer:C,dealer:p,direction:h})}async function oe(){if(S)return!1;x>0?await re():(x++,await A(w,C))}function ce(e,t,n){x=0,E=0,null!=t&&(p=t,S=!1),null!=n&&(h=n),C=e}function se(){return{currentPlayer:C,dealer:p,currentColor:b,cardOnBoard:g,color:N(g),type:q(g)}}function le(e,t,n){e.sort(((e,r)=>{const a=N(e),o=N(r);if(a==o)return"asc"===t?O(e)-O(r):O(r)-O(e);for(const e of n){if(e==a)return"asc"===t?-1:1;if(e==o)return"asc"===t?1:-1}}))}function ie(e,t){return e.maxScore&&(f=e.maxScore),{chooseDealer:function(){return async function(e){w=await s.newShuffledDeck(u,e);let t=[...y];for(;t.length>1;){const e=t.length;let n=new Array(e),r=0;for(let a=0;a<e;a++){const o=L(a,e);C=o;const c=O(await A(w,t[o].getIndex()));n[o]=c,r=Math.max(r,c)}const a=[];for(let o=0;o<e;o++)n[o]===r&&a.push(t[o]);t=a}t.length>=1&&(p=t[0].getIndex()),C=p,await u.changeCurrent({currentPlayer:C,dealer:p,direction:h})}(t)},deal:function(){return K(e.cardsDeal,t)},getPlayerIterator:F,addPlayer:B,size:J,on:W,cardScore:O,cardColor:N,cardType:q,getDealer:z,getCurrentPlayer:G,getCardOnBoard:I,tryMove:Y,moveToDiscard:Z,drawCurrent:oe,setDeck:function(e){m=!1,null==w?w=s.newExternalDeck(e,u,t):w.setDeck(e)},onDraw:M,onMove:R,onDiscard:_,setCurrent:ce,cleanHand:$,nextDealer:ae,onDrawPlayer:j,pass:H,getCurrentColor:k,getDirection:P,state:se,onNewRound:te,onPass:ne,sortByTemplate:le}}const de=["red","yellow","green","blue"];function ue(e,t,n,r){return n.on("chooseColor",(()=>function(e,t){return new Promise(((n,r)=>{t.inColorChoose=!0;const a=e.querySelector(".color-picker-holder");a.replaceChildren();const o=e.createElement("ul");o.classList.add("color-grid"),a.appendChild(o);for(const r of de){const c=e.createElement("li");c.classList.add(r),c.addEventListener("click",(e=>{e.preventDefault(),a.replaceChildren(),t.inColorChoose=!1,n(r)})),o.appendChild(c)}const c=e.createElement("li");c.classList.add("cancel-color"),c.addEventListener("click",(e=>{e.preventDefault(),a.replaceChildren(),t.inColorChoose=!1,n("black")})),o.appendChild(c)}))}(t,r))),{}}function fe(e,t){const n=t.content.cloneNode(!0).firstElementChild;return n.style.setProperty("--sprite-x",1400-e%14*100+"%"),n.style.setProperty("--sprite-y",800-100*Math.floor(e/14)+"%"),n.dataset.card=e,n}function pe(e,t,n,r,a){const o=e.createElement("ul"),c=e.querySelector("#card");o.classList.add("hand"),a&&a.sortByColor&&r.sortByTemplate(n,a.sortByColor,a.colorOrder);for(const e of n)o.appendChild(fe(e,c));t.appendChild(o)}function he(e,t,n,r,a,o){const c=t.querySelector(".places");let s=c.querySelector(".center-pile");s?s.replaceChildren():(s=t.createElement("div"),s.classList.add("center-pile"),c.appendChild(s)),null!==n&&function(e,t,n,r,a,o){const c=e.createElement("ul"),s=e.querySelector("#card");c.classList.add("hand"),c.appendChild(fe(n,s));const l=e.querySelector("#back").content.cloneNode(!0).firstElementChild;c.appendChild(l),l.addEventListener("click",(async e=>{e.preventDefault(),"ai"===a?await r.drawCurrent():null==await r.onDrawPlayer(o)&&await r.pass(o)})),t.appendChild(c)}(t,s,n,r,a,o)}function ye(e){const t={green:"rgba(85, 170, 85, 0.4)",red:"rgba(255, 85, 85, 0.4)",yellow:"rgba(255, 170, 0, 0.4)",blue:"rgba(85, 85, 255, 0.4)"}[e];return null!=t?t:"aliceblue"}function we(e,t,n,r,a){const o=t.documentElement;o.style.setProperty("--card-width","50px"),o.style.setProperty("--current-color",ye(n.getCurrentColor()));const c=t.querySelector(".places");c.replaceChildren();const s=t.createElement("ul");s.classList.add("circle-wrapper"),c.appendChild(s);const l=360/n.size(),i=n.getPlayerIterator();let d=0;const u=n.getDealer(),f=n.getCurrentPlayer();let p=null;for(const e of i){if(d===r){p=e,++d;continue}const o=90+l*(d-r),c=t.createElement("li"),i=t.createElement("div");if(i.innerText=e.getName(),c.appendChild(i),a.show)pe(t,c,e.pile(),n,a);else{const n=t.createElement("div");n.innerText=e.pile().length,c.appendChild(n)}const h=e.getScore();if(h>0){const e=t.createElement("div");e.innerText=h,c.appendChild(e)}c.dataset.id=d,c.dataset.angle=o+"deg",c.style.setProperty("--angle-deg",o+"deg"),c.classList.add("circle","player-name"),u===d&&c.classList.add("dealer"),f===d&&c.classList.add("current-player"),++d,s.appendChild(c)}he(0,t,n.getCardOnBoard(),n,"net",r),function(e,t,n,r,a,o,c){const s=t.createElement("div");s.classList.add("my-hand");const l=t.createElement("div");l.classList.add("row");const i=t.createElement("span");i.innerText=a.getName(),l.appendChild(i);const d=a.getScore();if(d>0){const e=t.createElement("span");e.innerText=d,l.appendChild(e)}const u=t.createElement("span"),f=t.createElement("img");f.src="./images/reload.svg",n.getDirection()>0&&f.classList.add("mirror"),u.appendChild(f),l.appendChild(u),s.appendChild(l),s.dataset.id=r,s.classList.add("player-name");const p=n.getDealer(),h=n.getCurrentPlayer();p===r&&s.classList.add("dealer"),h===r&&s.classList.add("current-player"),pe(t,s,a.pile(),n,c),s.addEventListener("click",(async e=>{e.preventDefault();const t=e.target.parentElement;if(t&&t.classList.contains("card")){const e=parseInt(t.dataset.card);await n.moveToDiscard(r,e)}})),o.appendChild(s)}(0,t,n,r,p,c,a)}const me={drawCenter:he,drawPlayers:function(e,t,n,r,a){a.clickAll?function(e,t,n,r,a){const o=t.documentElement;o.style.setProperty("--card-width","40px"),o.style.setProperty("--current-color",ye(n.getCurrentColor()));const c=t.querySelector(".places");c.replaceChildren();const s=t.createElement("ul");s.classList.add("circle-wrapper"),c.appendChild(s);const l=360/n.size(),i=n.getPlayerIterator();let d=0;const u=n.getDealer(),f=n.getCurrentPlayer();for(const e of i){const o=90+l*(d-r),c=t.createElement("li"),i=t.createElement("span");i.innerText=e.getName(),c.appendChild(i);const p=e.getScore();if(p>0){const e=t.createElement("span");e.innerText=p,c.appendChild(e)}pe(t,c,e.pile(),n,a),c.dataset.id=d,c.dataset.angle=o+"deg",c.style.setProperty("--angle-deg",o+"deg"),c.classList.add("circle","player-name"),u===d&&c.classList.add("dealer"),f===d&&c.classList.add("current-player"),s.appendChild(c),++d}he(0,t,n.getCardOnBoard(),n,"ai",r),s.addEventListener("click",(async e=>{e.preventDefault();const t=e.target.parentElement;if(t&&t.classList.contains("card")){const e=t.parentElement.parentElement,r=parseInt(t.dataset.card),a=parseInt(e.dataset.id);await n.moveToDiscard(a,r)}}))}(0,t,n,r,a):we(0,t,n,r,a)},drawLayout:we};function ge(e,t,n){let r=n&&n.state;r&&("object"==typeof r&&t.copy(r,t),e.state=()=>t.copy(t,{}))}class ve{constructor(e){null==e&&(e=+new Date);let t=4022871197;function n(e){e=String(e);for(let n=0;n<e.length;n++){t+=e.charCodeAt(n);let r=.02519603282416938*t;t=r>>>0,r-=t,r*=t,t=r>>>0,r-=t,t+=4294967296*r}return 2.3283064365386963e-10*(t>>>0)}this.c=1,this.s0=n(" "),this.s1=n(" "),this.s2=n(" "),this.s0-=n(e),this.s0<0&&(this.s0+=1),this.s1-=n(e),this.s1<0&&(this.s1+=1),this.s2-=n(e),this.s2<0&&(this.s2+=1)}next(){let{c:e,s0:t,s1:n,s2:r}=this,a=2091639*t+2.3283064365386963e-10*e;return this.s0=n,this.s1=r,this.s2=a-(this.c=0|a)}copy(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}}function Ce(e,t,n,a,o){let c=function(e,t){let n=new ve(e),r=()=>n.next();return r.double=()=>r()+11102230246251565e-32*(2097152*r()|0),r.int32=()=>4294967296*n.next()|0,r.quick=r,ge(r,n,t),r}(n.seed);const s=ie(n,c);let l=0,i=0;function d(){me.drawPlayers(e,t,s,i,n)}for(const e of a)s.addPlayer(e.name),e.external_id==n.externalId&&(i=l),++l;t.querySelector(".hand-cont");function u(e,n){const r=t.getElementsByClassName("overlay")[0],a=t.getElementsByClassName("close")[0],o=t.getElementsByClassName("install")[0];a.addEventListener("click",(function(e){e.preventDefault(),r.classList.remove("show")}),!1);r.querySelector("h2").textContent=e;r.querySelector(".content").textContent=n,r.classList.add("show"),o.classList.remove("hidden2")}return s.on("draw",(async({playerIndex:e,card:t})=>{d(),await(0,r.gw)(30),e!==i&&"server"!==n.mode||await o.draw({playerIndex:e,card:t})})),s.on("drawExternal",(async({playerIndex:e,card:t})=>{d(),await(0,r.gw)(30),"server"===n.mode&&await o.draw({playerIndex:e,card:t})})),s.on("changeCurrent",(async({currentPlayer:a,dealer:c,direction:l})=>{me.drawPlayers(e,t,s,i,n),await(0,r.gw)(30),"server"===n.mode&&await o.changeCurrent({currentPlayer:a,dealer:c,myIndex:i,direction:l})})),s.on("pass",(async({playerIndex:e})=>{await o.pass({playerIndex:e,myIndex:i})})),s.on("move",(async a=>{me.drawPlayers(e,t,s,i,n),await(0,r.gw)(30),a.playerIndex!==i&&"server"!==n.mode||await o.move(a)})),s.on("moveExternal",(async a=>{me.drawPlayers(e,t,s,i,n),await(0,r.gw)(30),"server"===n.mode&&await o.move(a)})),s.on("discard",(async e=>{d(),await(0,r.gw)(30),await o.discard(e)})),s.on("shuffle",(async e=>{d(),await(0,r.gw)(300),await o.shuffle(e)})),s.on("deal",(()=>{})),s.on("gameover",(async e=>{d();u(a[e.playerIndex].name+" wins","with score "+e.score),await o.gameover(e)})),s.on("clearPlayer",(async e=>{await o.clearPlayer(e)})),ue(0,t,s,{inColorChoose:!1,inExternalMove:!1}),s.on("roundover",(async e=>{"net"!==n.mode?(await o.roundover(e),await(0,r.gw)(300),await s.nextDealer(),await s.deal()):d()})),{start:async function(){await s.chooseDealer(),await(0,r.gw)(1e3),n.showAll?n.show=!0:n.show=!1,await s.deal()},onShuffle:async function(r){await s.setDeck(r),me.drawPlayers(e,t,s,i,n)},onDraw:function(e,t){return s.onDraw(e,t)},onDiscard:function(e){return s.onDiscard(e)},onChangeCurrent:async function(e){s.getCurrentPlayer()!==e.myIndex&&"server"==n.mode||(n.showAll?n.show=!0:n.show=!1,s.setCurrent(e.currentPlayer,e.dealer,e.direction),d())},onClearHand:async function(e){await s.cleanHand(e),d()},onMove:function(e){return s.onMove(e.playerIndex,e.card,e.currentColor)},onNewRound:async function(e){const t=await s.onNewRound(e);return d(),t},onGameOver:async function(e){return d(),u("","with score "+e.score),!0},cardToString:function(e){return s.cardColor(e)+" "+s.cardType(e)},onPass:function(e){return s.onPass(e.playerIndex)}}}function be(e){}function xe(e){}function Ee(e){let t="";for(const n of e)t+=n.external_id;return t}function Se(e,r,a){const o={move:be,moveExternal:be,drawExternal:be,gameover:be,username:be,start:xe,swap:xe,pass:xe,"uno-start":xe,shuffle:xe,draw:xe,discard:xe,chooseColor:xe,clearPlayer:be,changeCurrent:be,roundover:be};let c=null,s=[];function l(e,t){o[e]=t}const i=()=>{const e=r.querySelector(".qrcode");e&&(e.innerHTML=""),o.start(s)},d=r.querySelector(".start");d&&d.addEventListener("click",i),"ai"!=a.mode&&t(e,r,a,o);const u=async()=>{i(),a.seed||(a.seed=Ee(s)),c=Ce(e,r,a,s,o),await c.start()};l("onSeatsFinished",u);return{on:l,onChange:function(e){if(null!=c)return c.onMove(e)},join:(e,t,a)=>(s[e]={name:t,external_id:a},n(0,r,0,o,s),!0),start:i,onConnect:()=>{t(e,r,a,o)},swap:(e,t)=>{const a=s[e];s[e]=s[t],s[t]=a,n(0,r,0,o,s)},onStart:t=>{s=t,a.seed=Ee(s),c=Ce(e,r,a,s,o);r.getElementsByClassName("places")[0].removeAttribute("style")},afterAllJoined:u,onShuffle:e=>{if(null!=c)return c.onShuffle(e)},onDraw:(e,t)=>{if(null!=c)return c.onDraw(e,t)},onDiscard:e=>{if(null!=c)return c.onDiscard(e)},onNewRound:e=>{if(null!=c)return c.onNewRound(e)},onChangeCurrent:e=>{if(null!=c)return c.onChangeCurrent(e)},onClearHand:e=>{if(null!=c)return c.onClearHand(e)},onGameOver:e=>{if(null!=c)return c.onGameOver(e)},disconnect:e=>{const t=s.length;s=s.filter((t=>t.external_id!=e));const a=s.length;return n(0,r,0,o,s),t>a},cardToString:e=>{if(null!=c)return c.cardToString(e)},onPass:e=>{if(null!=c)return c.onPass(e)}}}"serviceWorker"in navigator&&(navigator.serviceWorker.register("./sw.js",{scope:"./"}),function(e,t){const n=t.querySelector(".butInstall");let a;n.addEventListener("click",(e=>{e.preventDefault(),(0,r.N8)(n),a.prompt(),a.userChoice.then((e=>{}))})),e.addEventListener("beforeinstallprompt",(e=>{e.preventDefault(),a=e,(0,r.oX)(n)}))}(window,document)),function(t,n){(0,r.Bk)(t,n,e),"net"===e.mode?a.e(970).then(a.bind(a,970)).then((r=>{r.default(t,n,e,Se)})):"server"===e.mode?a.e(749).then(a.bind(a,749)).then((r=>{r.default(t,n,e,Se)})):"ai"===e.mode?a.e(945).then(a.bind(a,945)).then((r=>{r.default(t,n,e,Se)})):(0,r.hu)(!1,"Unsupported mode")}(window,document)})()})();