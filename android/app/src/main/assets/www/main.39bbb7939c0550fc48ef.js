(()=>{"use strict";var e,n,t={392:(e,n,t)=>{function r(e){e&&e.remove()}function a(e,n,t){e.logger&&(t.innerHTML+="object"==typeof n?(JSON&&JSON.stringify?JSON.stringify(n):n)+"<br />":n+"<br />")}function o(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function c(e,n,t){const r=e.location.search,a=new URLSearchParams(r);for(const[e,n]of a)"number"==typeof t[e]?t[e]=parseInt(n,10):"boolean"==typeof t[e]?t[e]=o(n):t[e]=n}t.d(n,{Bk:()=>c,cM:()=>a,ew:()=>r,gw:()=>l,hu:()=>s});const l=e=>new Promise((n=>setTimeout(n,e)));function s(e,n){if(!e)throw n}},971:(e,n,t)=>{function r(e,n,t,r){const a=n.querySelector(".name-form-cont"),o=e.sessionStorage.getItem("username");if(o)return a.replaceChildren(),void(r&&r.username(o,"server"));const c=n.querySelector("#nameform").content.cloneNode(!0).firstElementChild;a.replaceChildren(c);const l=n.querySelector(".nameform"),s=n.querySelector(".nameinput"),i=n.querySelector(".container");"net"===t.mode&&i.classList.add("hidden"),l.addEventListener("submit",(function(n){var t;n.preventDefault(),t=s.value,e.sessionStorage.setItem("username",t),r&&r.username(t,"server"),l.classList.add("hidden"),i.classList.remove("hidden"),a.replaceChildren()}))}t.d(n,{Z:()=>r})}},r={};function a(e){var n=r[e];if(void 0!==n)return n.exports;var o=r[e]={exports:{}};return t[e](o,o.exports,a),o.exports}a.m=t,a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((n,t)=>(a.f[t](e,n),n)),[])),a.u=e=>e+"."+{297:"19f6941c4105feaf1765",745:"1442be4fbacc6446a429",945:"6466e1705e9b6987ab7c",970:"d9038fd8850abd5b0bf0"}[e]+".js",a.miniCssF=e=>{},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),e={},n="fool:",a.l=(t,r,o,c)=>{if(e[t])e[t].push(r);else{var l,s;if(void 0!==o)for(var i=document.getElementsByTagName("script"),d=0;d<i.length;d++){var u=i[d];if(u.getAttribute("src")==t||u.getAttribute("data-webpack")==n+o){l=u;break}}l||(s=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.setAttribute("data-webpack",n+o),l.src=t),e[t]=[r];var f=(n,r)=>{l.onerror=l.onload=null,clearTimeout(p);var a=e[t];if(delete e[t],l.parentNode&&l.parentNode.removeChild(l),a&&a.forEach((e=>e(r))),n)return n(r)},p=setTimeout(f.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=f.bind(null,l.onerror),l.onload=f.bind(null,l.onload),s&&document.head.appendChild(l)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var n=a.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");if(t.length)for(var r=t.length-1;r>-1&&!e;)e=t[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={179:0};a.f.j=(n,t)=>{var r=a.o(e,n)?e[n]:void 0;if(0!==r)if(r)t.push(r[2]);else{var o=new Promise(((t,a)=>r=e[n]=[t,a]));t.push(r[2]=o);var c=a.p+a.u(n),l=new Error;a.l(c,(t=>{if(a.o(e,n)&&(0!==(r=e[n])&&(e[n]=void 0),r)){var o=t&&("load"===t.type?"missing":t.type),c=t&&t.target&&t.target.src;l.message="Loading chunk "+n+" failed.\n("+o+": "+c+")",l.name="ChunkLoadError",l.type=o,l.request=c,r[1](l)}}),"chunk-"+n,n)}};var n=(n,t)=>{var r,o,[c,l,s]=t,i=0;if(c.some((n=>0!==e[n]))){for(r in l)a.o(l,r)&&(a.m[r]=l[r]);if(s)s(a)}for(n&&n(t);i<c.length;i++)o=c[i],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0},t=self.webpackChunkfool=self.webpackChunkfool||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})(),(()=>{const e={modes:["net","ai","server"],mode:"net",wsPort:8088,logger:!0,networkDebug:!0,cardsDeal:7,maxScore:500,showAll:!1,clickAll:!1,show:!0,externalId:"server",applyEffects:!0,colorOrder:["red","yellow","green","blue","black"],sortByColor:"",direction:["center"],seed:""};var n=a(971);function t(e,n,t,r,a){const o=n.querySelector(".places");o.replaceChildren();const c=n.createElement("ul");c.classList.add("circle-wrapper"),o.appendChild(c);const l=360/a.length;let s=90,i=null;c.addEventListener("click",(function(e){if(e.preventDefault(),e.target&&null!=e.target.dataset.id){if(i)return i.classList.remove("selected"),r.swap(i.dataset.id,e.target.dataset.id),void(i=null);i=e.target,i.classList.add("selected")}}));for(let e=0;e<a.length;++e){if(null==a[e]){s+=l;continue}const t=n.createElement("li");t.innerText=a[e].name,t.dataset.id=e,t.dataset.angle=s+"deg",t.style.setProperty("--angle-deg",s+"deg"),t.classList.add("circle","clickable"),s+=l,c.appendChild(t)}const d=n.createElement("button");d.textContent="Start",d.classList.add("start-button","clickable"),d.addEventListener("click",(function(e){e.preventDefault(),o.replaceChildren(),r.onSeatsFinished()})),o.appendChild(d)}var r=a(392);function o(e,n){for(let t=e.length-1;t>0;t--){const r=Math.floor(n()*(t+1)),a=e[t];e[t]=e[r],e[r]=a}}function c(e,n,t){let r=e;return{deal:function(){return r.pop()},addCardAndShuffle:function(e){return function(e){r.push(e)}(e),o(r,t),n.shuffle(r)},setDeck:function(e){r=e},checkTop:function(e){if(0===r.length)return!1;const n=r.at(-1)===e;return n},size:()=>r.length,shuffle:function(){return o(r,t),n.shuffle(r)}}}const l={newShuffledDeck:async function(e,n){const t=function(){const e=[...Array(112).keys()];return e.splice(56,1),e.splice(69,1),e.splice(82,1),e.splice(95,1),e}();return o(t,n),await e.shuffle(t),c(t,e,n)},newExternalDeck:c},s=["red","yellow","green","blue"];Object.freeze(s);function i(e){let n;if(e%14==13)return"black";switch(Math.floor(e/14)){case 0:case 4:n="red";break;case 1:case 5:n="yellow";break;case 2:case 6:n="green";break;case 3:case 7:n="blue"}return n}function d(e){switch(e%14){case 10:return"Skip";case 11:return"Reverse";case 12:return"Draw2";case 13:return Math.floor(e/14)>=4?"Draw4":"Wild";default:return"Number "+e%14}}function u(e){let n;switch(e%14){case 10:case 11:case 12:n=20;break;case 13:n=50;break;default:n=e%14}return n}const f={GOOD_COLORS:s,GameStage:Object.freeze({chooseDealer:1,dealing:2,round:3,gameOver:4}),cardColor:i,cardType:d,cardScore:u,sortByTemplate:function(e,n,t){const r="asc"===n?1:-1;e.sort(((e,n)=>{const a=i(e),o=i(n);if(a===o){const t=u(e)-u(n);return 0===t?(e-n)*r:t*r}for(const e of t){if(e===a)return-1;if(e===o)return 1}return 0}))},pileHasColor:function(e,n){return null!=e.find((e=>i(e)===n))},cardToString:function(e){return i(e)+" "+d(e)}};function p(e){}function h(e){}function y(e,n){(0,r.hu)(e,n)}const w={shuffle:h,deal:h,draw:h,discard:h,move:h,clearPlayer:h,changeCurrent:h,changeDealer:h,gameover:h,roundover:h,pass:p,drawExternal:p,moveExternal:p,chooseColor:I};let g=500,m=0,C=0,v=[],b=null,S=!0,x=null,E=[],D=null,L=null,k=0,P=0,O=!0;function I(){return L}function T(){return C}function N(e,n){return y(n>0,"Bad usage"),(e+C+n)%n}function B(e,n){return(m+(e+1)*C+n)%n}function q(){return x}function A(e){if(!e)return!1;const n=v.length;return v.push(function(e,n){const t=e,r=n,a=[];let o=0;return{getName:()=>t,addCard:e=>a.push(e),pile:()=>[...a],getIndex:()=>r,cleanHand:()=>{a.length=0},removeCard:e=>{const n=a.indexOf(e);return n<0||a.splice(n,1),n},updateScore:e=>{o+=e},getScore:()=>o,setScore:e=>{o=e},hasColor:e=>f.pileHasColor(a,e),hasCard:e=>a.includes(e)}}(e,n)),!0}async function j(e,n,t){if(null==e||0===e.size())return null;const r=e.deal();return null==r?null:(v[n].addCard(r),t?await async function(e,...n){const t=w[e];if("function"==typeof t)return await t(...n)}("drawExternal",{playerIndex:n,card:r}):await w.draw({playerIndex:n,card:r}),0===e.size()&&await function(){const e=E.pop();return b.setDeck(E),E=[e],b.shuffle()}(),r)}async function M(e,n){if(!b.checkTop(n))return!1;await j(b,e,!0);return k++,!0}async function z(e){if(e!==D)return!1;if(O)return!1;if(k>0)return!1;k++;return null!=await j(b,D)}async function R(e){if(e===D){if(O)return!1;if(0!=k)return await re(),await w.pass({playerIndex:e}),!0}}async function H(e,n,t){const r=await async function(e,n,t){const r=await async function(e,n,t){if(e!==D)return!1;if(!V().hasCard(n))return!1;if(!f.GOOD_COLORS.includes(t))return!1;if(O)return!1;if(P>0)return!1;if("Wild"===f.cardType(n))return!0;if("Draw4"===f.cardType(n))return!V().hasColor(L);if(f.cardColor(n)!==t)return!1;if(f.cardColor(n)===L)return!0;if(f.cardType(n)===f.cardType(x))return!0;return!1}(e,n,t);r&&(v[e].removeCard(n),x=n,E.push(n),L=t,++P,await w.moveExternal({playerIndex:e,card:n,currentColor:L}),S&&(await K(n,D),await ee(e)));return r}(e,n,t);return r}async function _(e){if(null==b||!b.checkTop(e))return;y(b.deal()===e,"Different cards"),x=e,await w.discard(e);const n=f.cardColor(e);"black"!==n&&(E.push(e),L=n)}function G(e,n){w[e]=n}function F(){return{[Symbol.iterator](){let e=0;return{next:()=>e>=v.length?{done:!0,value:e}:{done:!1,value:v[e++]},return:()=>({done:!0})}}}}function J(){return v.length}function W(){return m}function $(){return D}async function U(e){x=null,E=[],v[e].cleanHand(),await w.clearPlayer(e)}function Z(){D=N(D,v.length),k=0,P=0}async function K(e,n){const t=f.cardType(e);if("Reverse"===t&&(C*=-1,2===v.length&&Z()),"Skip"===t&&Z(),"Draw2"===t){Z();for(let e=0;e<2;++e)await j(b,D)}if("Draw4"===t){Z();for(let e=0;e<4;++e)await j(b,D)}await re()}async function Q(e){for(let n=0;n<e;++n){const e=v.length;for(let n=0;n<e;n++){const t=B(n,e),r=v[t].getIndex();await j(b,r)}}const n=await async function(e){O=!1,D=m,await w.changeCurrent({currentPlayer:D,dealer:m,direction:C});let n=e.deal();for(x=n,await w.discard(n);"black"===f.cardColor(n);)x=null,await e.addCardAndShuffle(n),n=e.deal(),x=n,await w.discard(n);return E.push(n),L=f.cardColor(n),n}(b);D=m,await K(n)}function V(){return v[D]}async function X(e,n){if(e!==D)return!1;if(!V().hasCard(n))return!1;if(O)return!1;if(P>0)return!1;if("Wild"===f.cardType(n)){const n=await w.chooseColor(e);return!!f.GOOD_COLORS.includes(n)&&(L=n,!0)}if("Draw4"===f.cardType(n)){if(V().hasColor(L))return!1;const n=await w.chooseColor(e);return!!f.GOOD_COLORS.includes(n)&&(L=n,!0)}return f.cardColor(n)===L||f.cardType(n)===f.cardType(x)}async function Y(e,n){const t=await X(e,n);if(t){v[e].removeCard(n),x=n,E.push(n);const t=f.cardColor(n);"black"!=t&&(L=t),++P,await w.move({playerIndex:e,card:n,currentColor:L}),S&&(await K(n),await ee(e))}return t}async function ee(e){const n=v[e];if(0===n.pile().length){O=!0;const t=function(){let e=0;const n=F();for(const t of n)for(const n of t.pile())e+=f.cardScore(n);return e}();n.updateScore(t),n.getScore()>=g?await w.gameover({playerIndex:e,score:n.getScore(),diff:t}):await w.roundover({playerIndex:e,score:n.getScore(),diff:t})}}async function ne(e){const n=v[e.playerIndex],t=n.getScore();k=0,P=0,O=!1,e.score==t+e.diff&&n.setScore(e.score)}function te(e){return e==D&&re()}async function re(){return Z(),k=0,P=0,await w.changeCurrent({currentPlayer:D,dealer:m,direction:C}),!0}async function ae(){return C=1,m=N(m,v.length),D=m,O=!1,k=0,P=0,await w.changeCurrent({currentPlayer:D,dealer:m,direction:C})}async function oe(){if(O)return!1;k>0?await re():(k++,await j(b,D))}function ce(e,n,t){k=0,P=0,null!=n&&(m=n,O=!1),null!=t&&(C=t),D=e}function le(){return{currentPlayer:D,dealer:m,currentColor:L,cardOnBoard:x,color:f.cardColor(x),type:f.cardType(x)}}function se(){return null==b?0:b.size()}function ie(e,n){return g=500,m=0,C=1,v=[],b=null,S=!0,x=null,E=[],D=null,L=null,k=0,P=0,O=!0,S=e.applyEffects,e.maxScore&&(g=e.maxScore),{chooseDealer:function(){return async function(e){b=await l.newShuffledDeck(w,e);let n=[...v];for(;n.length>1;){const e=n.length,t=new Array(e);let r=0;for(let a=0;a<e;a++){const o=B(a,e),c=n[o].getIndex(),l=await j(b,c),s=f.cardScore(l);t[o]=s,r=Math.max(r,s)}const a=[];for(let o=0;o<e;o++)t[o]===r&&a.push(n[o]);n=a}n.length>=1&&(m=n[0].getIndex()),D=m,await w.changeCurrent({currentPlayer:D,dealer:m,direction:C})}(n)},deal:async function(){return await async function(e){x=null,E=[];for(const e of v)e.cleanHand(),await w.clearPlayer(e.getIndex());b=await l.newShuffledDeck(w,e)}(n),Q(e.cardsDeal)},dealN:Q,getPlayerIterator:F,addPlayer:A,size:J,on:G,getDealer:W,getCurrentPlayer:$,getCardOnBoard:q,tryMove:X,moveToDiscard:Y,drawCurrent:oe,setDeck:function(e){null==b?b=l.newExternalDeck(e,w,n):b.setDeck(e)},onDraw:M,onMove:H,onDiscard:_,setCurrent:ce,cleanHand:U,nextDealer:ae,onDrawPlayer:z,pass:R,getCurrentColor:I,getDirection:T,state:le,onNewRound:ne,onPass:te,deckSize:se}}function de(e,n,t,r){return t.on("chooseColor",(()=>function(e,n){return new Promise((t=>{n.inColorChoose=!0;const r=e.querySelector(".color-picker-holder");r.replaceChildren();const a=e.createElement("ul");a.classList.add("color-grid"),r.appendChild(a);for(const o of f.GOOD_COLORS){const c=e.createElement("li");c.classList.add(o),c.addEventListener("click",(e=>{e.preventDefault(),r.replaceChildren(),n.inColorChoose=!1,t(o)})),a.appendChild(c)}const o=e.createElement("li");o.classList.add("cancel-color"),o.addEventListener("click",(e=>{e.preventDefault(),r.replaceChildren(),n.inColorChoose=!1,t("black")})),a.appendChild(o)}))}(n,r))),{}}function ue(e,n){const t=n.content.cloneNode(!0).firstElementChild;return t.style.setProperty("--sprite-x",1400-e%14*100+"%"),t.style.setProperty("--sprite-y",800-100*Math.floor(e/14)+"%"),t.dataset.card=e,t}function fe(e){const n=e.createElement("li");return n.classList.add("blank"),n}function pe(e,n,t,r,a){const o=e.createElement("ul"),c=e.querySelector("#card");o.classList.add("hand"),a&&a.sortByColor&&f.sortByTemplate(t,a.sortByColor,a.colorOrder);for(const e of t)o.appendChild(ue(e,c));n.appendChild(o)}function he(e,n,t){we(t.size(),t.getDirection(),e,n,"big-circle",t.getCurrentColor())}function ye(e,n,t,r,a,o){const c=n.querySelector(".places");let l=c.querySelector(".center-pile");l?l.replaceChildren():(l=n.createElement("div"),l.classList.add("center-pile"),c.appendChild(l)),function(e,n,t,r,a,o){const c=e.createElement("ul"),l=e.querySelector("#card");if(c.classList.add("hand"),null!==t?c.appendChild(ue(t,l)):c.appendChild(fe(e)),0===r.deckSize())c.appendChild(fe(e));else{const n=e.querySelector("#back").content.cloneNode(!0).firstElementChild;n.addEventListener("click",(async e=>{e.preventDefault(),"ai"===a?await r.drawCurrent():await r.onDrawPlayer(o)||await r.pass(o)})),c.appendChild(n)}n.appendChild(c)}(n,l,t,r,a,o)}function we(e,n,t,r,a,o){if(2===e||0===n)return;const c=r.createElement("span");c.classList.add(a);const l=r.createElement("div");l.classList.add("direction"),o&&l.classList.add(o),1===n&&l.classList.add("mirror"),c.appendChild(l),t.appendChild(c)}function ge(e){const n={green:"rgba(85, 170, 85, 0.4)",red:"rgba(255, 85, 85, 0.4)",yellow:"rgba(255, 170, 0, 0.4)",blue:"rgba(85, 85, 255, 0.4)"}[e];return null!=n?n:"aliceblue"}function me(e,n,t,r,a){n.documentElement.style.setProperty("--current-color",ge(t.getCurrentColor()));const o=n.querySelector(".places");o.replaceChildren(),he(o,n,t);const c=n.createElement("ul");c.classList.add("circle-wrapper"),o.appendChild(c);const l=360/t.size(),s=t.getPlayerIterator();let i=0;const d=t.getDealer(),u=t.getCurrentPlayer();let f=null;for(const e of s){if(i===r){f=e,++i;continue}const t=90+l*(i-r),o=n.createElement("li");if(a.show)pe(n,o,e.pile(),0,a);else{const t=n.createElement("div");t.innerText=e.pile().length,t.classList.add("card-count"),o.appendChild(t)}const s=n.createElement("div");s.classList.add("player-name"),s.innerText=e.getName(),o.appendChild(s);const p=e.getScore();if(p>0){const e=n.createElement("div");e.innerText=p,o.appendChild(e)}o.dataset.id=i,o.dataset.angle=t+"deg",o.style.setProperty("--angle-deg",t+"deg"),o.classList.add("circle"),u===i&&o.classList.add("current-player"),d===i&&o.classList.add("dealer"),++i,c.appendChild(o)}ye(0,n,t.getCardOnBoard(),t,"net",r),function(e,n,t,r,a,o,c){const l=n.createElement("div");l.classList.add("my-hand");const s=n.createElement("div");s.classList.add("row");const i=n.createElement("span");i.innerText=a.getName(),i.classList.add("player-name"),s.appendChild(i);const d=a.getScore();if(d>0){const e=n.createElement("span");e.innerText=d,s.appendChild(e)}c.direction&&c.direction.includes("hand")&&we(t.size(),t.getDirection(),s,n,"sprite-container"),l.appendChild(s),l.dataset.id=r,t.getCurrentPlayer()===r&&l.classList.add("current-player"),t.getDealer()===r&&l.classList.add("dealer"),pe(n,l,a.pile(),0,c),l.addEventListener("click",(async e=>{e.preventDefault();const n=e.target.parentElement;if(n&&n.classList.contains("card")){const e=parseInt(n.dataset.card);await t.moveToDiscard(r,e)}})),o.appendChild(l)}(0,n,t,r,f,o,a)}const Ce={drawCenter:ye,drawPlayers:function(e,n,t,r,a,o){a.clickAll?function(e,n,t,r,a,o){n.documentElement.style.setProperty("--current-color",ge(t.getCurrentColor()));const c=n.querySelector(".places");c.replaceChildren(),he(c,n,t);const l=n.createElement("ul");l.classList.add("circle-wrapper"),c.appendChild(l);const s=360/t.size(),i=t.getPlayerIterator();let d=0;const u=t.getDealer(),f=t.getCurrentPlayer();for(const e of i){const t=90+s*(d-r),o=n.createElement("li");o.classList.add("show-all");const c=n.createElement("span");c.innerText=e.getName(),c.classList.add("player-name"),o.appendChild(c);const i=e.getScore();if(i>0){const e=n.createElement("span");e.innerText=i,o.appendChild(e)}pe(n,o,e.pile(),0,a),o.dataset.id=d,o.dataset.angle=t+"deg",o.style.setProperty("--angle-deg",t+"deg"),o.classList.add("circle","player-hand"),u===d&&o.classList.add("dealer"),f===d&&o.classList.add("current-player"),l.appendChild(o),++d}ye(0,n,t.getCardOnBoard(),t,"ai",r),l.addEventListener("click",(async e=>{e.preventDefault();const n=e.target.parentElement;if(n&&n.classList.contains("card")){const e=n.parentElement.parentElement,r=parseInt(n.dataset.card),a=parseInt(e.dataset.id);await t.moveToDiscard(a,r)}}))}(0,n,t,r,a):me(0,n,t,r,a)},drawLayout:me};function ve(e,n,t){let r=t&&t.state;r&&("object"==typeof r&&n.copy(r,n),e.state=()=>n.copy(n,{}))}class be{constructor(e){null==e&&(e=+new Date);let n=4022871197;function t(e){e=String(e);for(let t=0;t<e.length;t++){n+=e.charCodeAt(t);let r=.02519603282416938*n;n=r>>>0,r-=n,r*=n,n=r>>>0,r-=n,n+=4294967296*r}return 2.3283064365386963e-10*(n>>>0)}this.c=1,this.s0=t(" "),this.s1=t(" "),this.s2=t(" "),this.s0-=t(e),this.s0<0&&(this.s0+=1),this.s1-=t(e),this.s1<0&&(this.s1+=1),this.s2-=t(e),this.s2<0&&(this.s2+=1)}next(){let{c:e,s0:n,s1:t,s2:r}=this,a=2091639*n+2.3283064365386963e-10*e;return this.s0=t,this.s1=r,this.s2=a-(this.c=0|a)}copy(e,n){return n.c=e.c,n.s0=e.s0,n.s1=e.s1,n.s2=e.s2,n}}function Se(e,n,t,a,o){const c=function(e,n){let t=new be(e),r=()=>t.next();return r.double=()=>r()+11102230246251565e-32*(2097152*r()|0),r.int32=()=>4294967296*t.next()|0,r.quick=r,ve(r,t,n),r}(t.seed),l=ie(t,c);let s=0,i=0;function d(r){Ce.drawPlayers(e,n,l,i,t,r)}for(const e of a)l.addPlayer(e.name),e.external_id==t.externalId&&(i=s),++s;function u(e,t){const r=n.getElementsByClassName("overlay")[0],a=n.getElementsByClassName("close")[0],o=n.getElementsByClassName("install")[0];a.addEventListener("click",(function(e){e.preventDefault(),r.classList.remove("show")}),!1);r.querySelector("h2").textContent=e;r.querySelector(".content").textContent=t,r.classList.add("show"),o.classList.remove("hidden2")}l.on("draw",(async({playerIndex:e,card:n})=>{d("draw");const a=Date.now();e!==i&&"server"!==t.mode||await o.draw({playerIndex:e,card:n});const c=Date.now();await(0,r.gw)(150-c+a)})),l.on("drawExternal",(async({playerIndex:e,card:n})=>{d("drawExternal");const a=Date.now();"server"===t.mode&&await o.draw({playerIndex:e,card:n});const c=Date.now();await(0,r.gw)(200-c+a)})),l.on("changeCurrent",(async({currentPlayer:e,dealer:n,direction:a})=>{d("changeCurrent"),"server"===t.mode&&await o.changeCurrent({currentPlayer:e,dealer:n,myIndex:i,direction:a}),await(0,r.gw)(50)})),l.on("pass",(async({playerIndex:e})=>{await o.pass({playerIndex:e,myIndex:i})})),l.on("move",(async e=>{d("move"),e.playerIndex!==i&&"server"!==t.mode||await o.move(e),await(0,r.gw)(30)})),l.on("moveExternal",(async e=>{d("moveExternal"),"server"===t.mode&&await o.move(e),await(0,r.gw)(30)})),l.on("discard",(async e=>{d("discard"),await o.discard(e),await(0,r.gw)(30)})),l.on("shuffle",(async e=>{d("shuffle"),await o.shuffle(e),await(0,r.gw)(300)})),l.on("deal",(()=>{})),l.on("gameover",(async e=>{d();u(a[e.playerIndex].name+" wins","with score "+e.score),await o.gameover(e)})),l.on("clearPlayer",(async e=>{await o.clearPlayer(e),d()})),de(0,n,l,{inColorChoose:!1,inExternalMove:!1}),l.on("roundover",(async e=>{"net"!==t.mode?(await o.roundover(e),await(0,r.gw)(300),await l.nextDealer(),await l.deal()):d()}));return{on:function(e,n){o[e]=n},start:async function(){await o.start({players:a,engine:l}),await l.chooseDealer(),await(0,r.gw)(1e3),t.showAll?t.show=!0:t.show=!1,await l.deal()},onShuffle:async function(r){await l.setDeck(r),Ce.drawPlayers(e,n,l,i,t)},onDraw:function(e,n){return l.onDraw(e,n)},onDiscard:function(e){return l.onDiscard(e)},onChangeCurrent:async function(e){l.getCurrentPlayer()!==e.myIndex&&"server"==t.mode||(t.showAll?t.show=!0:t.show=!1,l.setCurrent(e.currentPlayer,e.dealer,e.direction),d())},onClearHand:async function(e){await l.cleanHand(e)},onMove:function(e){return l.onMove(e.playerIndex,e.card,e.currentColor)},onNewRound:async function(e){const n=await l.onNewRound(e);return d(),n},onGameOver:async function(e){return d(),u(a[e.playerIndex].name+" wins","with score "+e.score),!0},onPass:function(e){return l.onPass(e.playerIndex)},getEngine:()=>l}}function xe(e){}function Ee(e){}function De(e){let n="";for(const t of e)n+=t.external_id;return n}function Le(e,r,a){const o={move:xe,username:xe,draw:Ee,pass:Ee,changeCurrent:xe,discard:Ee,shuffle:Ee,clearPlayer:xe,roundover:xe,gameover:xe,start:Ee,swap:Ee,onSeatsFinished:Ee};let c=null,l=[];return{on:function(e,n){o[e]=n},onChange:function(e){if(null!=c)return c.onMove(e)},join:(e,n,a)=>(l[e]={name:n,external_id:a},t(0,r,0,o,l),!0),onConnect:()=>{(0,n.Z)(e,r,a,o)},swap:(e,n)=>{const a=l[e];l[e]=l[n],l[n]=a,t(0,r,0,o,l)},onStart:n=>{l=n,a.seed=De(l),c=Se(e,r,a,l,o);r.getElementsByClassName("places")[0].classList.remove("connected","loading","flying-cards")},afterAllJoined:async()=>{a.seed||(a.seed=De(l)),c=Se(e,r,a,l,o),await c.start()},onShuffle:e=>{if(null!=c)return c.onShuffle(e)},onDraw:(e,n)=>{if(null!=c)return c.onDraw(e,n)},onDiscard:e=>{if(null!=c)return c.onDiscard(e)},onNewRound:e=>{if(null!=c)return c.onNewRound(e)},onChangeCurrent:e=>{if(null!=c)return c.onChangeCurrent(e)},onClearHand:e=>{if(null!=c)return c.onClearHand(e)},onGameOver:e=>{if(null!=c)return c.onGameOver(e)},disconnect:e=>{const n=l.length;l=l.filter((n=>n.external_id!=e));const a=l.length;return t(0,r,0,o,l),n>a},onPass:e=>{if(null!=c)return c.onPass(e)},actionKeys:()=>Object.keys(o),getHandlers:()=>o}}(function(n,t){(0,r.Bk)(n,t,e),"net"===e.mode?a.e(970).then(a.bind(a,970)).then((r=>{r.default(n,t,e,Le).catch((e=>{}))})):"server"===e.mode?a.e(745).then(a.bind(a,745)).then((r=>{r.default(n,t,e,Le)})):"ai"===e.mode?a.e(945).then(a.bind(a,945)).then((r=>{r.default(n,t,e,Le)})):"test"===e.mode?a.e(297).then(a.bind(a,297)).then((r=>{r.default(n,t,e,Le)})):(0,r.hu)(!1,"Unsupported mode")})(window,document)})()})();