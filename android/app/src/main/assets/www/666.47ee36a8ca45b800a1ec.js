"use strict";(self.webpackChunkfool=self.webpackChunkfool||[]).push([[666],{211:(e,n,o)=>{o.d(n,{A:()=>r});var t=o(541);function r(e,n){return Object.assign({},(0,t.A)(e,n),{changeCurrent:e.setCurrentObj,shuffle:e.setDeck,clearPlayer:e.cleanHandExternal,discard:e.onDiscard,roundover:e.onEndRound,gameover:e.onEndRound})}},345:(e,n,o)=>{o.d(n,{$0:()=>a,CD:()=>i,wp:()=>c});var t=o(746),r=o(272);function s(){}function c(e,n,o){const t=e.sessionStorage.getItem(n.idNameInStorage);if(t)return t;const s=r.A.makeId(n.idNameLen,o);e.sessionStorage.setItem(n.idNameInStorage,s)}function a(e,n){return e.wh?e.wh:"https:"!==n.protocol?"ws://"+n.hostname+":"+e.wsPort:void 0}function i(e,n,o){const r=(0,t.A)(["error","open","message","beforeclose","close"]),c=new WebSocket(n);function a(e){o.log("Websocket message received: "+e);const n=JSON.parse(e);return r.call("message",n)}return c.addEventListener("open",(function(){return r.call("open",e)})),c.onclose=function(n){return o.log("Websocket closed "+n.code+" "+n.reason),r.call("close",e)},c.onmessage=async function(e){if(e.data instanceof Blob){return a(await e.data.text())}return a(e.data)},c.onerror=function(n){return o.error(n),r.call("error",e)},{on:(e,n)=>r.on(e,n),send:(n,t,r,s)=>{const a={from:e,to:r,action:n,data:t,ignore:s};return o.log("Sending ["+e+"] to ["+r+"]: "+JSON.stringify(t)),c.send(JSON.stringify(a))},close:async()=>(await r.call("beforeclose",e),c.onerror=s,c.close()),ready:function(){return new Promise((e=>{1===c.readyState?e():c.addEventListener("open",e)}))}}}},554:(e,n,o)=>{o.d(n,{A:()=>r});var t=o(217);async function r(e){let n;return"websocket"===e.connection?n=await o.e(249).then(o.bind(o,249)):"fake"===e.connection?n=await o.e(433).then(o.bind(o,433)):"net"===e.mode&&"webrtc"===e.connection?n=await o.e(111).then(o.bind(o,111)):"server"===e.mode&&"webrtc"===e.connection?n=await o.e(251).then(o.bind(o,251)):(0,t.v)(!1,"Unsupported mode"),n.default}},666:(e,n,o)=>{o.r(n),o.d(n,{default:()=>l});var t=o(345),r=o(554),s=o(211),c=o(911),a=o(42),i=o(776),d=o(233);async function l(e,n,o,l){const u=await(0,r.A)(o);return new Promise(((r,f)=>{(0,i.A)(e,n,o);const g=(0,t.wp)(e,o,Math.random),m=(0,a.A)(2,null,o),w=u(g,m,!1),p=(0,t.$0)(o,e.location);if(!p)return m.error("Can't determine ws address",p),void f(p);w.on("error",(e=>{m.error(e),f(e)})),function(e,n,o){n.on("socket_open",(()=>{const t=e.querySelector(".places");t.classList.add("loading"),o.log("socket_open");const r=()=>{o.log("socket_close"),t.classList.remove("loading"),t.classList.add("flying-cards")};n.on("socket_close",r),n.on("open",r)}))}(n,w,m),w.on("open",(t=>{m.log("Server id "+t);const i=(0,d.A)(console);o.applyEffects=!1;const u=l({window:e,document:n,settings:o,myId:g});!function(e,n,o,t){const r=Object.keys((0,c.A)({},null));r.push("username");for(const s of r)o.log("setup handler",s),e.on(s,(e=>{if(!e||!e.externalId||t===e.externalId)return n.sendRawTo(s,e,"server");o.log("Ignore",e.externalId)}))}(u,w,m,g);const f={start:e=>{const n=u.onStart(e),t=(0,a.A)(6,null,o),r=n.getEngine(),c=(0,s.A)(r,t);return w.registerHandler(c,i),n}};w.registerHandler(f,i),u.onConnect(),r(u)})),w.connect(p).catch((e=>{m.error(e),f(e)}))}))}},233:(e,n,o)=>{function t(e){let n=Promise.resolve();return{add:o=>new Promise(((t,r)=>{n=n.then(o).then(t).catch((n=>{e.log(n),r(n)}))}))}}o.d(n,{A:()=>t})}}]);